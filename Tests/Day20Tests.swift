import XCTest
@testable import AdventOfCode

@MainActor
final class Day20Tests: XCTestCase {
    func testDay20_1a() throws {
        let input = """
                 A
                 A
          #######.#########
          #######.........#
          #######.#######.#
          #######.#######.#
          #######.#######.#
          #####  B    ###.#
        BC...##  C    ###.#
          ##.##       ###.#
          ##...DE  F  ###.#
          #####    G  ###.#
          #########.#####.#
        DE..#######...###.#
          #.#########.###.#
        FG..#########.....#
          ###########.#####
                     Z
                     Z
        """
        let day = Day20(input: input)
        XCTAssertEqual(day.part1(), 23)
    }

    func testDay20_1b() throws {
        let input = """
                           A
                           A
          #################.#############
          #.#...#...................#.#.#
          #.#.#.###.###.###.#########.#.#
          #.#.#.......#...#.....#.#.#...#
          #.#########.###.#####.#.#.###.#
          #.............#.#.....#.......#
          ###.###########.###.#####.#.#.#
          #.....#        A   C    #.#.#.#
          #######        S   P    #####.#
          #.#...#                 #......VT
          #.#.#.#                 #.#####
          #...#.#               YN....#.#
          #.###.#                 #####.#
        DI....#.#                 #.....#
          #####.#                 #.###.#
        ZZ......#               QG....#..AS
          ###.###                 #######
        JO..#.#.#                 #.....#
          #.#.#.#                 ###.#.#
          #...#..DI             BU....#..LF
          #####.#                 #.#####
        YN......#               VT..#....QG
          #.###.#                 #.###.#
          #.#...#                 #.....#
          ###.###    J L     J    #.#.###
          #.....#    O F     P    #.#...#
          #.###.#####.#.#####.#####.###.#
          #...#.#.#...#.....#.....#.#...#
          #.#####.###.###.#.#.#########.#
          #...#.#.....#...#.#.#.#.....#.#
          #.###.#####.###.###.#.#.#######
          #.#.........#...#.............#
          #########.###.###.#############
                   B   J   C
                   U   P   P
        """
        let day = Day20(input: input)
        XCTAssertEqual(day.part1(), 58)
    }

    func testDay20_2a() throws {
        let input = """
                 A
                 A
          #######.#########
          #######.........#
          #######.#######.#
          #######.#######.#
          #######.#######.#
          #####  B    ###.#
        BC...##  C    ###.#
          ##.##       ###.#
          ##...DE  F  ###.#
          #####    G  ###.#
          #########.#####.#
        DE..#######...###.#
          #.#########.###.#
        FG..#########.....#
          ###########.#####
                     Z
                     Z
        """
        let day = Day20(input: input)
        XCTAssertEqual(day.part2(), 26)
    }

    func testDay20_2b() throws {
        let input = """
                           A
                           A
          #################.#############
          #.#...#...................#.#.#
          #.#.#.###.###.###.#########.#.#
          #.#.#.......#...#.....#.#.#...#
          #.#########.###.#####.#.#.###.#
          #.............#.#.....#.......#
          ###.###########.###.#####.#.#.#
          #.....#        A   C    #.#.#.#
          #######        S   P    #####.#
          #.#...#                 #......VT
          #.#.#.#                 #.#####
          #...#.#               YN....#.#
          #.###.#                 #####.#
        DI....#.#                 #.....#
          #####.#                 #.###.#
        ZZ......#               QG....#..AS
          ###.###                 #######
        JO..#.#.#                 #.....#
          #.#.#.#                 ###.#.#
          #...#..DI             BU....#..LF
          #####.#                 #.#####
        YN......#               VT..#....QG
          #.###.#                 #.###.#
          #.#...#                 #.....#
          ###.###    J L     J    #.#.###
          #.....#    O F     P    #.#...#
          #.###.#####.#.#####.#####.###.#
          #...#.#.#...#.....#.....#.#...#
          #.#####.###.###.#.#.#########.#
          #...#.#.....#...#.#.#.#.....#.#
          #.###.#####.###.###.#.#.#######
          #.#.........#...#.............#
          #########.###.###.#############
                   B   J   C
                   U   P   P
        """
        let day = Day20(input: input)
        XCTAssertEqual(day.part2(), 0)
    }

    func testDay20_2c() throws {
        let input = """
             Z L X W       C
             Z P Q B       K
  ###########.#.#.#.#######.###############
  #...#.......#.#.......#.#.......#.#.#...#
  ###.#.#.#.#.#.#.#.###.#.#.#######.#.#.###
  #.#...#.#.#...#.#.#...#...#...#.#.......#
  #.###.#######.###.###.#.###.###.#.#######
  #...#.......#.#...#...#.............#...#
  #.#########.#######.#.#######.#######.###
  #...#.#    F       R I       Z    #.#.#.#
  #.###.#    D       E C       H    #.#.#.#
  #.#...#                           #...#.#
  #.###.#                           #.###.#
  #.#....OA                       WB..#.#..ZH
  #.###.#                           #.#.#.#
CJ......#                           #.....#
  #######                           #######
  #.#....CK                         #......IC
  #.###.#                           #.###.#
  #.....#                           #...#.#
  ###.###                           #.#.#.#
XF....#.#                         RF..#.#.#
  #####.#                           #######
  #......CJ                       NM..#...#
  ###.#.#                           #.###.#
RE....#.#                           #......RF
  ###.###        X   X       L      #.#.#.#
  #.....#        F   Q       P      #.#.#.#
  ###.###########.###.#######.#########.###
  #.....#...#.....#.......#...#.....#.#...#
  #####.#.###.#######.#######.###.###.#.#.#
  #.......#.......#.#.#.#.#...#...#...#.#.#
  #####.###.#####.#.#.#.#.###.###.#.###.###
  #.......#.....#.#...#...............#...#
  #############.#.#.###.###################
               A O F   N
               A A D   M
"""
        let day = Day20(input: input)
        XCTAssertEqual(day.part2(), 396)
    }
}
